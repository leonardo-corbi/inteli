<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %></title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <!-- CSS Principal -->
    <link rel="stylesheet" href="/css/style.css" />

    <style>
      .auth-container {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(
          135deg,
          var(--primary-blue) 0%,
          var(--secondary-blue) 100%
        );
        padding: 1rem;
      }

      .auth-card {
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        padding: 2.5rem;
        width: 100%;
        max-width: 400px;
        position: relative;
        overflow: hidden;
      }

      .auth-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(
          90deg,
          var(--primary-blue),
          var(--secondary-blue)
        );
      }

      .auth-header {
        text-align: center;
        margin-bottom: 2rem;
      }

      .auth-logo {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 64px;
        height: 64px;
        background: linear-gradient(
          135deg,
          var(--primary-blue),
          var(--secondary-blue)
        );
        border-radius: 16px;
        margin-bottom: 1rem;
        color: white;
      }

      .auth-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--gray-900);
        margin: 0 0 0.5rem 0;
      }

      .auth-subtitle {
        color: var(--gray-600);
        margin: 0;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-label {
        display: block;
        font-weight: 500;
        color: var(--gray-700);
        margin-bottom: 0.5rem;
      }

      .form-control {
        width: 100%;
        padding: 0.75rem 1rem;
        border: 2px solid var(--gray-200);
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.2s ease;
        background: white;
      }

      .form-control:focus {
        outline: none;
        border-color: var(--primary-blue);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .btn-auth {
        width: 100%;
        padding: 0.875rem 1rem;
        background: linear-gradient(
          135deg,
          var(--primary-blue),
          var(--secondary-blue)
        );
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        margin-bottom: 1rem;
      }

      .btn-auth:hover {
        transform: translateY(-1px);
        box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
      }

      .auth-link {
        text-align: center;
        color: var(--gray-600);
      }

      .auth-link a {
        color: var(--primary-blue);
        text-decoration: none;
        font-weight: 500;
      }

      .auth-link a:hover {
        text-decoration: underline;
      }

      .alert {
        padding: 0.75rem 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
        font-size: 0.875rem;
      }

      .alert-error {
        background: #fef2f2;
        color: #dc2626;
        border: 1px solid #fecaca;
      }

      .alert-success {
        background: #f0fdf4;
        color: #16a34a;
        border: 1px solid #bbf7d0;
      }

      .password-toggle {
        position: relative;
      }

      .password-toggle-btn {
        position: absolute;
        right: 0.75rem;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        color: var(--gray-500);
        cursor: pointer;
        padding: 0.25rem;
      }

      .password-toggle-btn:hover {
        color: var(--gray-700);
      }
    </style>
  </head>
  <body>
    <div class="auth-container">
      <div class="auth-card">
        <div class="auth-header">
          <div class="auth-logo">
            <i
              data-lucide="calendar-check"
              style="width: 32px; height: 32px"
            ></i>
          </div>
          <h1 class="auth-title">Entrar no Sistema</h1>
          <p class="auth-subtitle">
            Faça login para acessar o sistema de reservas
          </p>
        </div>

        <% if (typeof error !== 'undefined' && error) { %>
        <div class="alert alert-error">
          <i
            data-lucide="alert-circle"
            style="
              width: 16px;
              height: 16px;
              display: inline;
              margin-right: 0.5rem;
            "
          ></i>
          <%= error %>
        </div>
        <% } %> <% if (typeof success !== 'undefined' && success) { %>
        <div class="alert alert-success">
          <i
            data-lucide="check-circle"
            style="
              width: 16px;
              height: 16px;
              display: inline;
              margin-right: 0.5rem;
            "
          ></i>
          <%= success %>
        </div>
        <% } %>

        <form method="POST" action="/api/auth/login">
          <div class="form-group">
            <label for="email" class="form-label">Email</label>
            <input
              type="email"
              id="email"
              name="email"
              class="form-control"
              placeholder="seu@email.com"
              value="<%= typeof formData !== 'undefined' && formData.email ? formData.email : '' %>"
              required
            />
          </div>

          <div class="form-group">
            <label for="senha" class="form-label">Senha</label>
            <div class="password-toggle">
              <input
                type="password"
                id="senha"
                name="senha"
                class="form-control"
                placeholder="Sua senha"
                required
              />
              <button
                type="button"
                class="password-toggle-btn"
                onclick="togglePassword('senha')"
              >
                <i
                  data-lucide="eye"
                  id="senha-icon"
                  style="width: 16px; height: 16px"
                ></i>
              </button>
            </div>
          </div>

          <button type="submit" class="btn-auth">
            <i
              data-lucide="log-in"
              style="
                width: 16px;
                height: 16px;
                margin-right: 0.5rem;
                display: inline;
              "
            ></i>
            Entrar
          </button>
        </form>

        <div class="auth-link">
          Não tem uma conta? <a href="/register">Criar conta</a>
        </div>

        <hr
          style="
            margin: 1.5rem 0;
            border: none;
            border-top: 1px solid var(--gray-200);
          "
        />

        <div
          style="
            text-align: center;
            color: var(--gray-500);
            font-size: 0.875rem;
          "
        >
          <strong>Contas de teste:</strong><br />
          Admin: admin@reservasalas.com / admin123<br />
          Usuário: joao.silva@empresa.com / 123456
        </div>
      </div>
    </div>

    <script>
      // Inicializar ícones Lucide
      lucide.createIcons();

      // Função para alternar visibilidade da senha
      function togglePassword(fieldId) {
        const field = document.getElementById(fieldId);
        const icon = document.getElementById(fieldId + "-icon");

        if (field.type === "password") {
          field.type = "text";
          icon.setAttribute("data-lucide", "eye-off");
        } else {
          field.type = "password";
          icon.setAttribute("data-lucide", "eye");
        }

        lucide.createIcons();
      }

      // Capturar parâmetros da URL para mostrar mensagens
      const urlParams = new URLSearchParams(window.location.search);
      const error = urlParams.get("error");
      const success = urlParams.get("success");

      if (error && !document.querySelector(".alert-error")) {
        const alertDiv = document.createElement("div");
        alertDiv.className = "alert alert-error";
        alertDiv.innerHTML = `<i data-lucide="alert-circle" style="width: 16px; height: 16px; display: inline; margin-right: 0.5rem;"></i>${error}`;
        document
          .querySelector("form")
          .parentNode.insertBefore(alertDiv, document.querySelector("form"));
        lucide.createIcons();
      }

      if (success && !document.querySelector(".alert-success")) {
        const alertDiv = document.createElement("div");
        alertDiv.className = "alert alert-success";
        alertDiv.innerHTML = `<i data-lucide="check-circle" style="width: 16px; height: 16px; display: inline; margin-right: 0.5rem;"></i>${success}`;
        document
          .querySelector("form")
          .parentNode.insertBefore(alertDiv, document.querySelector("form"));
        lucide.createIcons();
      }
    </script>
  </body>
</html>
