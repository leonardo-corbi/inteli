<div class="fade-in">
    <!-- Header da página -->
    <div class="d-flex justify-between items-center mb-4">
        <div>
            <h2 style="margin: 0; color: var(--gray-900);">Novo Usuário</h2>
            <p style="margin: 0.5rem 0 0; color: var(--gray-600);">Cadastre um novo usuário no sistema</p>
        </div>
        <a href="/users" class="btn btn-secondary">
            <i data-lucide="arrow-left" style="width: 16px; height: 16px; margin-right: 0.5rem;"></i>
            Voltar
        </a>
    </div>
    
    <!-- Formulário -->
    <div class="row">
        <div class="col-8">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i data-lucide="user-plus" style="width: 20px; height: 20px; margin-right: 0.5rem; display: inline;"></i>
                        Dados do Usuário
                    </h3>
                </div>
                <div class="card-body">
                    <% if (typeof error !== 'undefined' && error) { %>
                        <div class="alert alert-error mb-4">
                            <i data-lucide="alert-circle" style="width: 16px; height: 16px; display: inline; margin-right: 0.5rem;"></i>
                            <%= error %>
                        </div>
                    <% } %>
                    
                    <form method="POST" action="/users" id="userForm">
                        <div class="row">
                            <div class="col-12 mb-3">
                                <label for="nome" class="form-label">Nome Completo *</label>
                                <input 
                                    type="text" 
                                    id="nome" 
                                    name="nome" 
                                    class="form-control" 
                                    placeholder="Digite o nome completo"
                                    value="<%= typeof formData !== 'undefined' && formData.nome ? formData.nome : '' %>"
                                    required
                                >
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-6 mb-3">
                                <label for="email" class="form-label">Email *</label>
                                <input 
                                    type="email" 
                                    id="email" 
                                    name="email" 
                                    class="form-control" 
                                    placeholder="usuario@empresa.com"
                                    value="<%= typeof formData !== 'undefined' && formData.email ? formData.email : '' %>"
                                    required
                                >
                            </div>
                            <div class="col-6 mb-3">
                                <label for="matricula" class="form-label">Matrícula *</label>
                                <input 
                                    type="text" 
                                    id="matricula" 
                                    name="matricula" 
                                    class="form-control" 
                                    placeholder="USR001"
                                    value="<%= typeof formData !== 'undefined' && formData.matricula ? formData.matricula : '' %>"
                                    required
                                >
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-6 mb-3">
                                <label for="tipo" class="form-label">Tipo de Usuário *</label>
                                <select id="tipo" name="tipo" class="form-control form-select" required>
                                    <option value="">Selecione o tipo</option>
                                    <option value="usuario" <%= typeof formData !== 'undefined' && formData.tipo === 'usuario' ? 'selected' : '' %>>Usuário</option>
                                    <option value="admin" <%= typeof formData !== 'undefined' && formData.tipo === 'admin' ? 'selected' : '' %>>Administrador</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="d-flex gap-2 mt-4">
                            <button type="submit" class="btn btn-primary">
                                <i data-lucide="save" style="width: 16px; height: 16px; margin-right: 0.5rem;"></i>
                                Salvar Usuário
                            </button>
                            <a href="/users" class="btn btn-secondary">
                                <i data-lucide="x" style="width: 16px; height: 16px; margin-right: 0.5rem;"></i>
                                Cancelar
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <div class="col-4">
            <!-- Informações de Ajuda -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i data-lucide="info" style="width: 20px; height: 20px; margin-right: 0.5rem; display: inline;"></i>
                        Informações
                    </h3>
                </div>
                <div class="card-body">
                    <div style="font-size: 0.875rem; color: var(--gray-600); line-height: 1.5;">
                        <h4 style="font-size: 1rem; color: var(--gray-900); margin-bottom: 0.5rem;">Tipos de Usuário:</h4>
                        
                        <div style="margin-bottom: 1rem;">
                            <div style="font-weight: 500; color: var(--primary-blue); margin-bottom: 0.25rem;">
                                <i data-lucide="shield" style="width: 14px; height: 14px; margin-right: 0.25rem; display: inline;"></i>
                                Administrador
                            </div>
                            <div>Acesso completo ao sistema, pode gerenciar usuários, salas e reservas.</div>
                        </div>
                        
                        <div style="margin-bottom: 1rem;">
                            <div style="font-weight: 500; color: var(--info); margin-bottom: 0.25rem;">
                                <i data-lucide="user" style="width: 14px; height: 14px; margin-right: 0.25rem; display: inline;"></i>
                                Usuário
                            </div>
                            <div>Pode criar e gerenciar suas próprias reservas.</div>
                        </div>
                        
                        <hr style="margin: 1rem 0; border: none; border-top: 1px solid var(--gray-200);">
                        
                        <h4 style="font-size: 1rem; color: var(--gray-900); margin-bottom: 0.5rem;">Dicas:</h4>
                        <ul style="margin: 0; padding-left: 1rem;">
                            <li>Use emails corporativos</li>
                            <li>Matrículas devem ser únicas</li>
                            <li>Nomes completos facilitam identificação</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Usuários Recentes -->
            <div class="card mt-3">
                <div class="card-header">
                    <h3 class="card-title">
                        <i data-lucide="clock" style="width: 20px; height: 20px; margin-right: 0.5rem; display: inline;"></i>
                        Últimos Cadastros
                    </h3>
                </div>
                <div class="card-body">
                    <div style="font-size: 0.875rem;">
                        <div style="display: flex; align-items: center; margin-bottom: 0.75rem;">
                            <div style="width: 32px; height: 32px; background: var(--primary-blue); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 0.75rem;">
                                <i data-lucide="user" style="width: 16px; height: 16px; color: white;"></i>
                            </div>
                            <div>
                                <div style="font-weight: 500; color: var(--gray-900);">João Silva</div>
                                <div style="color: var(--gray-500); font-size: 0.75rem;">Usuário</div>
                            </div>
                        </div>
                        
                        <div style="display: flex; align-items: center; margin-bottom: 0.75rem;">
                            <div style="width: 32px; height: 32px; background: var(--success); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 0.75rem;">
                                <i data-lucide="shield" style="width: 16px; height: 16px; color: white;"></i>
                            </div>
                            <div>
                                <div style="font-weight: 500; color: var(--gray-900);">Admin Sistema</div>
                                <div style="color: var(--gray-500); font-size: 0.75rem;">Administrador</div>
                            </div>
                        </div>
                        
                        <div style="display: flex; align-items: center;">
                            <div style="width: 32px; height: 32px; background: var(--info); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 0.75rem;">
                                <i data-lucide="user" style="width: 16px; height: 16px; color: white;"></i>
                            </div>
                            <div>
                                <div style="font-weight: 500; color: var(--gray-900);">Maria Santos</div>
                                <div style="color: var(--gray-500); font-size: 0.75rem;">Usuário</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Validação do formulário
    document.getElementById('userForm').addEventListener('submit', function(e) {
        const nome = document.getElementById('nome').value.trim();
        const email = document.getElementById('email').value.trim();
        const matricula = document.getElementById('matricula').value.trim();
        const tipo = document.getElementById('tipo').value;
        
        if (!nome || !email || !matricula || !tipo) {
            e.preventDefault();
            alert('Todos os campos obrigatórios devem ser preenchidos!');
            return false;
        }
        
        // Validar formato do email
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            e.preventDefault();
            alert('Por favor, insira um email válido!');
            return false;
        }
        
        // Validar matrícula (apenas letras e números)
        const matriculaRegex = /^[A-Za-z0-9]+$/;
        if (!matriculaRegex.test(matricula)) {
            e.preventDefault();
            alert('A matrícula deve conter apenas letras e números!');
            return false;
        }
    });
    
    // Auto-gerar matrícula baseada no nome
    document.getElementById('nome').addEventListener('blur', function() {
        const matriculaField = document.getElementById('matricula');
        if (!matriculaField.value) {
            const nome = this.value.trim();
            if (nome) {
                const palavras = nome.split(' ');
                let matricula = '';
                
                if (palavras.length >= 2) {
                    matricula = palavras[0].substring(0, 3).toUpperCase() + 
                               palavras[palavras.length - 1].substring(0, 3).toUpperCase();
                } else {
                    matricula = palavras[0].substring(0, 6).toUpperCase();
                }
                
                // Adicionar números aleatórios
                matricula += Math.floor(Math.random() * 100).toString().padStart(2, '0');
                
                matriculaField.value = matricula;
            }
        }
    });
</script>

